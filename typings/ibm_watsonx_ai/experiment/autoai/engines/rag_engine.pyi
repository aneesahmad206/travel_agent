"""
This type stub file was generated by pyright.
"""

from pathlib import Path
from typing import Any, TYPE_CHECKING
from pandas import DataFrame
from ibm_watsonx_ai.helpers.connections import DataConnection
from ibm_watsonx_ai.utils.autoai.knowledge_base import BaseKnowledgeBase
from ibm_watsonx_ai.utils.autoai.utils import run_id_required
from ibm_watsonx_ai.wml_resource import WMLResource
from ibm_watsonx_ai.foundation_models.extensions.rag.pattern import RAGPattern
from ibm_watsonx_ai.workspace import WorkSpace

if TYPE_CHECKING:
    ...
__all__ = ["RAGEngine"]
class RAGEngine(WMLResource):
    """RAG Engine provides unified API to work with AutoAI RAG Pattern on WML.

    :param workspace: WorkSpace object with wml client and all needed parameters
    :type workspace: WorkSpace
    """
    def __init__(self, workspace: WorkSpace) -> None:
        ...
    
    def run(self, *, input_data_references: list[DataConnection] | None, results_reference: DataConnection, test_data_references: list[DataConnection] | None = ..., vector_store_references: list[DataConnection] | None = ..., background_mode: bool = ..., knowledge_base_references: list[BaseKnowledgeBase] | None = ...) -> dict:
        """Engine for create an AutoAI RAG job that will find the best RAG pattern.

        :param input_data_references: data storage connection details to inform where training data is stored
        :type input_data_references: list[DataConnection], optional

        :param results_reference: the training results
        :type results_reference: DataConnection

        :param test_data_references: set of test data references
        :type test_data_references: list[DataConnection], optional

        :param vector_store_references: set of vector store references
        :type vector_store_references: list[DataConnection], optional

        :param background_mode: indicator if run() method will run in background (async) or (sync)
        :type background_mode: bool, optional

        :param knowledge_base_references: collection of knowledge base references
        :type knowledge_base_references: list[BaseKnowledgeBase], optional

        :return: run details
        :rtype: dict

        """
        ...
    
    @run_id_required
    def cancel_run(self, hard_delete: bool = ...) -> str:
        """Engine for cancels a RAG Optimizer run.

        :param hard_delete: specify `True` or `False`:

            * `True` - to delete the completed or canceled training run
            * `False` - to cancel the currently running training run
        :type hard_delete: bool, optional

        :return: status "SUCCESS" if cancellation is successful
        :rtype: str

        """
        ...
    
    def get_details(self, run_id: str | None = ..., limit: int | None = ..., get_all: bool = ...) -> dict:
        """Engine for get details.

        :param run_id: ID of the fit/run
        :type run_id: str, optional

        :param limit: limit number of fetched records
        :type limit: int, optional

        :param get_all: if `True`, it will get all entries in 'limited' chunks, defaults to `False`
        :type get_all: bool, optional

        :return: RAGOptimizer details
        :rtype: dict

        """
        ...
    
    @run_id_required
    def get_run_status(self) -> str:
        """Engine for check status/state of initialized RAGOptimizer run if ran in background mode.

        :return: run status details
        :rtype: str

        """
        ...
    
    @run_id_required
    def get_run_details(self) -> dict:
        """Engine for get run details.

        :return: RAGOptimizer run details
        :rtype: dict

        """
        ...
    
    @staticmethod
    def sort_results_by_metric(details: dict, metric_name: str) -> list:
        """
        Method for sort results by metric

        :param details: pattern details
        :type details: dict

        :param metric_name: metrics name to be sorted by
        :type metric_name: dict

        :return: clist of sorted metrics
        :rtype: list

        """
        ...
    
    def summary(self, scoring: str | list[str] | None = ...) -> DataFrame:
        """Engine for return RAGOptimizer summary details.

        :param scoring: scoring metric which user wants to use to sort patterns by,
            when not provided use optimized one
        :type scoring: str | list, optional

        :return: computed patterns and metrics
        :rtype: pandas.DataFrame

        """
        ...
    
    def get_pattern(self, pattern_name: str | None = ...) -> RAGPattern:
        """Engine for return RAGPattern from RAGOptimizer training.

        :param pattern_name: pattern name, if you want to see the patterns names, please use summary() method,
            if this parameter is None, the best pattern will be fetched
        :type pattern_name: str, optional

        :return: RAGPattern class for defining, querying and deploying Retrieval-Augmented Generation (RAG) patterns.
        :rtype: RAGPattern

        """
        ...
    
    def get_pattern_details(self, pattern_name: str | None = ...) -> dict:
        """Engine for fetch specific pattern details, e.g. steps etc.

        :param pattern_name: pattern name e.g. Pattern1, if not specified, best pattern parameters will be fetched
        :type pattern_name: str, optional

        :return: pattern parameters
        :rtype: dict

        """
        ...
    
    def get_inference_notebook(self, pattern_name: str | None = ..., local_path: str | Path = ..., filename: str | None = ...) -> str:
        """Engine for download specified inference notebook from Service.

        :param pattern_name: pattern name, if you want to see the patterns names, please use summary() method,
            if this parameter is None, the best pattern will be fetched
        :type pattern_name: str, optional

        :param local_path: local filesystem path, if not specified, current directory is used
        :type local_path: str | Path, optional

        :param filename: filename under which the pattern notebook will be saved
        :type filename: str, optional

        :return: path to saved inference notebook
        :rtype: str

        """
        ...
    
    def get_indexing_notebook(self, pattern_name: str | None = ..., local_path: str | Path = ..., filename: str | None = ...) -> str:
        """Engine for download specified indexing notebook from Service.

        :param pattern_name: pattern name, if you want to see the patterns names, please use summary() method,
            if this parameter is None, the best pattern will be fetched
        :type pattern_name: str, optional

        :param local_path: local filesystem path, if not specified, current directory is used
        :type local_path: str | Path, optional

        :param filename: filename under which the pattern notebook will be saved
        :type filename: str, optional

        :return: path to saved indexing notebook
        :rtype: str

        """
        ...
    
    def get_best_pattern_details(self, details: dict[str, Any], pattern_name: str | None = ...) -> dict[str, Any]:
        """
        Return best pattern details

        :param details: pattern details
        :type details: dict

        :param pattern_name: pattern name, if you want to see the patterns names, please use summary() method,
            if this parameter is None, the best pattern will be fetched
        :type pattern_name: str, optional

        :return: pattern parameters
        :rtype: dict

        """
        ...
    
    def get_logs(self) -> str:
        """
        Get logs of an AutoAI RAG job

        return: path to saved logs
        :rtype: str

        """
        ...
    
    def get_evaluation_results(self, pattern_name: str | None = ...) -> str:
        """
        Get evaluation results of an AutoAI RAG job

        :param pattern_name: pattern name, if you want to see the patterns names, please use summary() method,
            if this parameter is None, the best pattern will be fetched
        :type pattern_name: str, optional

        return: path to saved evaluation results
        :rtype: str

        """
        ...
    
    def initiate_optimizer_metadata(self, params: dict, **kwargs: Any) -> None:
        """Method for initiate optimizer metadata"""
        ...
    


